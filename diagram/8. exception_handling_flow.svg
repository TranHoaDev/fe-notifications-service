<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="ACTIVITY" height="746px" preserveAspectRatio="none" style="width:589px;height:746px;background:#FFFFFF;" version="1.1" viewBox="0 0 589 746" width="589px" zoomAndPan="magnify"><defs/><g><ellipse cx="350.3839" cy="20" fill="#222222" rx="10" ry="10" style="stroke:#222222;stroke-width:1;"/><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="213.9277" x="243.42" y="50"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="193.9277" x="253.42" y="71.1387">TeamsController.sendMessage()</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="226.1855" x="237.2911" y="103.9688"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="206.1855" x="247.2911" y="125.1074">TeamsGraphClient.sendMessage()</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="240.7168" x="230.0255" y="157.9375"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="220.7168" x="240.0255" y="179.0762">TokenManager.getDelegatedToken()</text><polygon fill="#F1F1F1" points="269.4523,211.9063,431.3156,211.9063,443.3156,223.9063,431.3156,235.9063,269.4523,235.9063,257.4523,223.9063,269.4523,211.9063" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="161.8633" x="269.4523" y="227.7144">Token operations successful?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="19.0083" x="238.444" y="221.312">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="13.7017" x="443.3156" y="221.312">no</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="165.6055" x="118.0505" y="245.9063"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="145.6055" x="128.0505" y="267.0449">Send to Microsoft Graph</text><polygon fill="#F1F1F1" points="117.5342,299.875,284.1724,299.875,296.1724,311.875,284.1724,323.875,117.5342,323.875,105.5342,311.875,117.5342,299.875" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="166.6382" x="117.5342" y="315.6831">Microsoft Graph response OK?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="19.0083" x="86.5259" y="309.2808">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="13.7017" x="296.1724" y="309.2808">no</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="169.0684" x="11" y="333.875"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="149.0684" x="21" y="355.0137">Return success message</text><ellipse cx="95.5342" cy="398.8438" fill="none" rx="11" ry="11" style="stroke:#222222;stroke-width:1;"/><ellipse cx="95.5342" cy="398.8438" fill="#222222" rx="6" ry="6" style="stroke:#222222;stroke-width:1;"/><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="170.7676" x="220.7886" y="333.875"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="150.7676" x="230.7886" y="355.0137">Throw RuntimeException</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="156.7168" x="421.5562" y="245.9063"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="136.7168" x="431.5562" y="267.0449">Throw TokenException</text><polygon fill="#F1F1F1" points="350.3839,419.8438,362.3839,431.8438,350.3839,443.8438,338.3839,431.8438,350.3839,419.8438" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="187.2266" x="256.7706" y="463.8438"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="167.2266" x="266.7706" y="484.9824">Check TokenException type</text><polygon fill="#F1F1F1" points="272.9327,517.8125,427.8351,517.8125,439.8351,529.8125,427.8351,541.8125,272.9327,541.8125,260.9327,529.8125,272.9327,517.8125" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="154.9023" x="272.9327" y="533.6206">requiresReAuthentication()?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="19.0083" x="241.9244" y="527.2183">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="13.7017" x="439.8351" y="527.2183">no</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="93.7227" x="196.297" y="551.8125"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="73.7227" x="206.297" y="572.9512">Log warning</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="171.6699" x="157.3234" y="605.7813"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="151.6699" x="167.3234" y="626.9199">Return 401 Unauthorized</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="174.6348" x="155.8409" y="659.75"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="154.6348" x="165.8409" y="680.8887">Include authorization URL</text><ellipse cx="243.1583" cy="724.7188" fill="none" rx="11" ry="11" style="stroke:#222222;stroke-width:1;"/><ellipse cx="243.1583" cy="724.7188" fill="#222222" rx="6" ry="6" style="stroke:#222222;stroke-width:1;"/><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="74.9844" x="420.1173" y="551.8125"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="54.9844" x="430.1173" y="572.9512">Log error</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="214.2676" x="350.4757" y="605.7813"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="194.2676" x="360.4757" y="626.9199">Return 500 Internal Server Error</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="192.5645" x="361.3273" y="659.75"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="172.5645" x="371.3273" y="680.8887">Include token error message</text><ellipse cx="457.6095" cy="724.7188" fill="none" rx="11" ry="11" style="stroke:#222222;stroke-width:1;"/><ellipse cx="457.6095" cy="724.7188" fill="#222222" rx="6" ry="6" style="stroke:#222222;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="350.3839" x2="350.3839" y1="30" y2="50"/><polygon fill="#181818" points="346.3839,40,350.3839,50,354.3839,40,350.3839,44" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="350.3839" x2="350.3839" y1="83.9688" y2="103.9688"/><polygon fill="#181818" points="346.3839,93.9688,350.3839,103.9688,354.3839,93.9688,350.3839,97.9688" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="350.3839" x2="350.3839" y1="137.9375" y2="157.9375"/><polygon fill="#181818" points="346.3839,147.9375,350.3839,157.9375,354.3839,147.9375,350.3839,151.9375" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="95.5342" x2="95.5342" y1="367.8438" y2="387.8438"/><polygon fill="#181818" points="91.5342,377.8438,95.5342,387.8438,99.5342,377.8438,95.5342,381.8438" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="105.5342" x2="95.5342" y1="311.875" y2="311.875"/><line style="stroke:#181818;stroke-width:1;" x1="95.5342" x2="95.5342" y1="311.875" y2="333.875"/><polygon fill="#181818" points="91.5342,323.875,95.5342,333.875,99.5342,323.875,95.5342,327.875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="296.1724" x2="306.1724" y1="311.875" y2="311.875"/><line style="stroke:#181818;stroke-width:1;" x1="306.1724" x2="306.1724" y1="311.875" y2="333.875"/><polygon fill="#181818" points="302.1724,323.875,306.1724,333.875,310.1724,323.875,306.1724,327.875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="306.1724" x2="306.1724" y1="367.8438" y2="431.8438"/><line style="stroke:#181818;stroke-width:1;" x1="306.1724" x2="338.3839" y1="431.8438" y2="431.8438"/><polygon fill="#181818" points="328.3839,427.8438,338.3839,431.8438,328.3839,435.8438,332.3839,431.8438" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="200.8533" x2="200.8533" y1="279.875" y2="299.875"/><polygon fill="#181818" points="196.8533,289.875,200.8533,299.875,204.8533,289.875,200.8533,293.875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="257.4523" x2="200.8533" y1="223.9063" y2="223.9063"/><line style="stroke:#181818;stroke-width:1;" x1="200.8533" x2="200.8533" y1="223.9063" y2="245.9063"/><polygon fill="#181818" points="196.8533,235.9063,200.8533,245.9063,204.8533,235.9063,200.8533,239.9063" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="443.3156" x2="499.9146" y1="223.9063" y2="223.9063"/><line style="stroke:#181818;stroke-width:1;" x1="499.9146" x2="499.9146" y1="223.9063" y2="245.9063"/><polygon fill="#181818" points="495.9146,235.9063,499.9146,245.9063,503.9146,235.9063,499.9146,239.9063" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="499.9146" x2="499.9146" y1="279.875" y2="431.8438"/><line style="stroke:#181818;stroke-width:1;" x1="499.9146" x2="362.3839" y1="431.8438" y2="431.8438"/><polygon fill="#181818" points="372.3839,427.8438,362.3839,431.8438,372.3839,435.8438,368.3839,431.8438" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="350.3839" x2="350.3839" y1="191.9063" y2="211.9063"/><polygon fill="#181818" points="346.3839,201.9063,350.3839,211.9063,354.3839,201.9063,350.3839,205.9063" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="350.3839" x2="350.3839" y1="443.8438" y2="463.8438"/><polygon fill="#181818" points="346.3839,453.8438,350.3839,463.8438,354.3839,453.8438,350.3839,457.8438" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="243.1583" x2="243.1583" y1="585.7813" y2="605.7813"/><polygon fill="#181818" points="239.1583,595.7813,243.1583,605.7813,247.1583,595.7813,243.1583,599.7813" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="243.1583" x2="243.1583" y1="639.75" y2="659.75"/><polygon fill="#181818" points="239.1583,649.75,243.1583,659.75,247.1583,649.75,243.1583,653.75" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="243.1583" x2="243.1583" y1="693.7188" y2="713.7188"/><polygon fill="#181818" points="239.1583,703.7188,243.1583,713.7188,247.1583,703.7188,243.1583,707.7188" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="457.6095" x2="457.6095" y1="585.7813" y2="605.7813"/><polygon fill="#181818" points="453.6095,595.7813,457.6095,605.7813,461.6095,595.7813,457.6095,599.7813" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="457.6095" x2="457.6095" y1="639.75" y2="659.75"/><polygon fill="#181818" points="453.6095,649.75,457.6095,659.75,461.6095,649.75,457.6095,653.75" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="457.6095" x2="457.6095" y1="693.7188" y2="713.7188"/><polygon fill="#181818" points="453.6095,703.7188,457.6095,713.7188,461.6095,703.7188,457.6095,707.7188" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="260.9327" x2="243.1583" y1="529.8125" y2="529.8125"/><line style="stroke:#181818;stroke-width:1;" x1="243.1583" x2="243.1583" y1="529.8125" y2="551.8125"/><polygon fill="#181818" points="239.1583,541.8125,243.1583,551.8125,247.1583,541.8125,243.1583,545.8125" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="439.8351" x2="457.6095" y1="529.8125" y2="529.8125"/><line style="stroke:#181818;stroke-width:1;" x1="457.6095" x2="457.6095" y1="529.8125" y2="551.8125"/><polygon fill="#181818" points="453.6095,541.8125,457.6095,551.8125,461.6095,541.8125,457.6095,545.8125" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="350.3839" x2="350.3839" y1="497.8125" y2="517.8125"/><polygon fill="#181818" points="346.3839,507.8125,350.3839,517.8125,354.3839,507.8125,350.3839,511.8125" style="stroke:#181818;stroke-width:1;"/><!--SRC=[RL51Ri8m4Bpd5NjCBeXAxGKELKLHXGgg5E01bhD9B9nrkjwKqjVNSKW55D_icPtP6NjHB4aosw5g_CAHiBCMUUAHYWrwhofCi_b8U6FLrWjhaEGEmnsGDeh20qygb5UqM2d18WAHOqf8umrSYwp4EFBWEws3JjdPvmoa3c1wGfyb4Cvi6rn076oCPkTTAH1tc4Uqbxi1WD6tGHNXu_s_N9JCKJgcqHQQ8SFyZ-35jV62DiYav2vcTpMx8-GTYMbm-QsnxJCCis5JKoRNG-U1cFc2Fb2JsQ96VRX1GKujdhjY_EnCI9JZIzT74QDZQMbsfwgrg-2ec0nLmq9ZqiVf0-n91GN7vWUBCxeYRRi2OGIYCkppzO376cxIz1R8xFZQu6awXHK9CYaBM-GlP5XUq4OdYLyV1Qvh7xpwKdu1]--></g></svg>