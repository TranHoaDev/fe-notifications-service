<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="CLASS" height="1286px" preserveAspectRatio="none" style="width:1060px;height:1286px;background:#FFFFFF;" version="1.1" viewBox="0 0 1060 1286" width="1060px" zoomAndPan="magnify"><defs/><g><!--class TeamsController--><g class="entity" data-entity="TeamsController" data-source-line="1" data-uid="ent0002" id="entity_TeamsController"><rect fill="#F1F1F1" height="162.0781" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="485.0127" x="257.58" y="7"/><ellipse cx="437.912" cy="23" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M440.8808,28.6406 Q440.3027,28.9375 439.662,29.0781 Q439.0214,29.2344 438.3183,29.2344 Q435.8183,29.2344 434.4902,27.5938 Q433.1777,25.9375 433.1777,22.8125 Q433.1777,19.6875 434.4902,18.0313 Q435.8183,16.375 438.3183,16.375 Q439.0214,16.375 439.662,16.5313 Q440.3183,16.6875 440.8808,16.9844 L440.8808,19.7031 Q440.2558,19.125 439.662,18.8594 Q439.0683,18.5781 438.4433,18.5781 Q437.0995,18.5781 436.412,19.6563 Q435.7245,20.7188 435.7245,22.8125 Q435.7245,24.9063 436.412,25.9844 Q437.0995,27.0469 438.4433,27.0469 Q439.0683,27.0469 439.662,26.7813 Q440.2558,26.5 440.8808,25.9219 L440.8808,28.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="115.8486" x="458.412" y="27.8467">TeamsController</text><line style="stroke:#181818;stroke-width:0.5;" x1="258.58" x2="741.5927" y1="39" y2="39"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="265.58" y="49.6484"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="209.542" x="277.58" y="55.9951">TokenManager tokenManager</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="265.58" y="65.9453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="261.6865" x="277.58" y="72.292">TeamsGraphClient teamsGraphClient</text><line style="stroke:#181818;stroke-width:0.5;" x1="258.58" x2="741.5927" y1="79.5938" y2="79.5938"/><ellipse cx="268.58" cy="93.2422" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="407.9551" x="277.58" y="96.5889">sendMessage(MessageRequest): ResponseEntity&lt;String&gt;</text><ellipse cx="268.58" cy="109.5391" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="459.0127" x="277.58" y="112.8857">setTokensManually(SetTokensRequest): ResponseEntity&lt;String&gt;</text><ellipse cx="268.58" cy="125.8359" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="381.1855" x="277.58" y="129.1826">handleCallback(String code): ResponseEntity&lt;String&gt;</text><ellipse cx="268.58" cy="142.1328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="349.9248" x="277.58" y="145.4795">getTokenStatus(): ResponseEntity&lt;TokenStatus&gt;</text><ellipse cx="268.58" cy="158.4297" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="238.3418" x="277.58" y="161.7764">logout(): ResponseEntity&lt;String&gt;</text></g><!--class TokenManager--><g class="entity" data-entity="TokenManager" data-source-line="11" data-uid="ent0003" id="entity_TokenManager"><rect fill="#F1F1F1" height="145.7813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="367.7969" x="50.18" y="418.56"/><ellipse cx="177.7899" cy="434.56" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M173.7117,430.3256 L173.7117,428.1694 L181.1024,428.1694 L181.1024,430.3256 L178.6336,430.3256 L178.6336,438.4038 L181.1024,438.4038 L181.1024,440.56 L173.7117,440.56 L173.7117,438.4038 L176.1805,438.4038 L176.1805,430.3256 L173.7117,430.3256 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="104.0771" x="198.2899" y="439.4067">TokenManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="51.18" x2="416.9769" y1="450.56" y2="450.56"/><line style="stroke:#181818;stroke-width:0.5;" x1="51.18" x2="416.9769" y1="458.56" y2="458.56"/><ellipse cx="61.18" cy="472.2084" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="199.9238" x="70.18" y="475.5551">getDelegatedToken(): String</text><ellipse cx="61.18" cy="488.5053" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="341.7969" x="70.18" y="491.852">exchangeCodeForToken(String): TokenResponse</text><ellipse cx="61.18" cy="504.8022" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="134.2578" x="70.18" y="508.1489">clearTokens(): void</text><ellipse cx="61.18" cy="521.0991" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="198.5225" x="70.18" y="524.4457">getAuthorizationUrl(): String</text><ellipse cx="61.18" cy="537.3959" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="217.7246" x="70.18" y="540.7426">getTokenStatus(): TokenStatus</text><ellipse cx="61.18" cy="553.6928" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="267.9824" x="70.18" y="557.0395">setTokensDirectly(String, String): void</text></g><!--class MicrosoftGraphTokenManager--><g class="entity" data-entity="MicrosoftGraphTokenManager" data-source-line="20" data-uid="ent0004" id="entity_MicrosoftGraphTokenManager"><rect fill="#F1F1F1" height="276.1563" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="365.1377" x="51.51" y="624.35"/><ellipse cx="124.1863" cy="640.35" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M127.155,645.9906 Q126.5769,646.2875 125.9363,646.4281 Q125.2956,646.5844 124.5925,646.5844 Q122.0925,646.5844 120.7644,644.9438 Q119.4519,643.2875 119.4519,640.1625 Q119.4519,637.0375 120.7644,635.3813 Q122.0925,633.725 124.5925,633.725 Q125.2956,633.725 125.9363,633.8813 Q126.5925,634.0375 127.155,634.3344 L127.155,637.0531 Q126.53,636.475 125.9363,636.2094 Q125.3425,635.9281 124.7175,635.9281 Q123.3738,635.9281 122.6863,637.0063 Q121.9988,638.0688 121.9988,640.1625 Q121.9988,642.2563 122.6863,643.3344 Q123.3738,644.3969 124.7175,644.3969 Q125.3425,644.3969 125.9363,644.1313 Q126.53,643.85 127.155,643.2719 L127.155,645.9906 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="211.2852" x="144.6863" y="645.1967">MicrosoftGraphTokenManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="52.51" x2="415.6477" y1="656.35" y2="656.35"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="59.51" y="666.9984"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="195.248" x="71.51" y="673.3451">RestTemplate restTemplate</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="59.51" y="683.2953"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="230.9863" x="71.51" y="689.642">GraphProperties graphProperties</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="59.51" y="699.5922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="178.4521" x="71.51" y="705.9389">ReentrantLock tokenLock</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="59.51" y="715.8891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="215.0518" x="71.51" y="722.2357">volatile String delegatedToken</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="59.51" y="732.1859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="194.4277" x="71.51" y="738.5326">volatile String refreshToken</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="59.51" y="748.4828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="248.3838" x="71.51" y="754.8295">volatile LocalDateTime tokenExpiry</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="59.51" y="764.7797"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="301.2803" x="71.51" y="771.1264">volatile LocalDateTime refreshTokenExpiry</text><line style="stroke:#181818;stroke-width:0.5;" x1="52.51" x2="415.6477" y1="778.4281" y2="778.4281"/><ellipse cx="62.51" cy="792.0766" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="199.9238" x="71.51" y="795.4232">getDelegatedToken(): String</text><ellipse cx="62.51" cy="808.3734" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="267.9824" x="71.51" y="811.7201">setTokensDirectly(String, String): void</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="59.51" y="821.6703"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="339.1377" x="71.51" y="828.017">extractExpiryFromToken(String): LocalDateTime</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="59.51" y="837.9672"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="164.7803" x="71.51" y="844.3139">isTokenValid(): boolean</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="59.51" y="854.2641"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="197.7295" x="71.51" y="860.6107">canRefreshToken(): boolean</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="59.51" y="870.5609"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="190.4355" x="71.51" y="876.9076">refreshAccessToken(): void</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="59.51" y="886.8578"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="259.6289" x="71.51" y="893.2045">updateTokens(TokenResponse): void</text></g><!--class TeamsGraphClient--><g class="entity" data-entity="TeamsGraphClient" data-source-line="38" data-uid="ent0005" id="entity_TeamsGraphClient"><rect fill="#F1F1F1" height="96.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="369.3623" x="168.4" y="245.38"/><ellipse cx="283.7564" cy="261.38" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M286.7252,267.0206 Q286.1471,267.3175 285.5064,267.4581 Q284.8658,267.6144 284.1627,267.6144 Q281.6627,267.6144 280.3346,265.9738 Q279.0221,264.3175 279.0221,261.1925 Q279.0221,258.0675 280.3346,256.4113 Q281.6627,254.755 284.1627,254.755 Q284.8658,254.755 285.5064,254.9113 Q286.1627,255.0675 286.7252,255.3644 L286.7252,258.0831 Q286.1002,257.505 285.5064,257.2394 Q284.9127,256.9581 284.2877,256.9581 Q282.9439,256.9581 282.2564,258.0363 Q281.5689,259.0988 281.5689,261.1925 Q281.5689,263.2863 282.2564,264.3644 Q282.9439,265.4269 284.2877,265.4269 Q284.9127,265.4269 285.5064,265.1613 Q286.1002,264.88 286.7252,264.3019 L286.7252,267.0206 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130.1494" x="304.2564" y="266.2267">TeamsGraphClient</text><line style="stroke:#181818;stroke-width:0.5;" x1="169.4" x2="536.7623" y1="277.38" y2="277.38"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="176.4" y="288.0284"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="209.542" x="188.4" y="294.3751">TokenManager tokenManager</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="176.4" y="304.3253"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="195.248" x="188.4" y="310.672">RestTemplate restTemplate</text><line style="stroke:#181818;stroke-width:0.5;" x1="169.4" x2="536.7623" y1="317.9738" y2="317.9738"/><ellipse cx="179.4" cy="331.6222" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="343.3623" x="188.4" y="334.9689">sendMessage(String chatId, String content): void</text></g><!--class GraphProperties--><g class="entity" data-entity="GraphProperties" data-source-line="44" data-uid="ent0006" id="entity_GraphProperties"><rect fill="#F1F1F1" height="162.0781" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="186.166" x="7" y="960.5"/><ellipse cx="39.9626" cy="976.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M42.9314,982.1406 Q42.3533,982.4375 41.7126,982.5781 Q41.072,982.7344 40.3689,982.7344 Q37.8689,982.7344 36.5408,981.0938 Q35.2283,979.4375 35.2283,976.3125 Q35.2283,973.1875 36.5408,971.5313 Q37.8689,969.875 40.3689,969.875 Q41.072,969.875 41.7126,970.0313 Q42.3689,970.1875 42.9314,970.4844 L42.9314,973.2031 Q42.3064,972.625 41.7126,972.3594 Q41.1189,972.0781 40.4939,972.0781 Q39.1501,972.0781 38.4626,973.1563 Q37.7751,974.2188 37.7751,976.3125 Q37.7751,978.4063 38.4626,979.4844 Q39.1501,980.5469 40.4939,980.5469 Q41.1189,980.5469 41.7126,980.2813 Q42.3064,980 42.9314,979.4219 L42.9314,982.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="114.249" x="57.9543" y="981.3467">GraphProperties</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="192.166" y1="992.5" y2="992.5"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="15" y="1003.1484"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97.6992" x="27" y="1009.4951">String clientId</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="15" y="1019.4453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="129.7393" x="27" y="1025.792">String clientSecret</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="15" y="1035.7422"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="105.1641" x="27" y="1042.0889">String tenantId</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="15" y="1052.0391"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="120.8252" x="27" y="1058.3857">String redirectUri</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="15" y="1068.3359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.2881" x="27" y="1074.6826">String scope</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="15" y="1084.6328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="160.166" x="27" y="1090.9795">int tokenBufferMinutes</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="15" y="1100.9297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="150.1855" x="27" y="1107.2764">int refreshTokenDays</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="192.166" y1="1114.5781" y2="1114.5781"/></g><!--class TokenException--><g class="entity" data-entity="TokenException" data-source-line="54" data-uid="ent0007" id="entity_TokenException"><rect fill="#F1F1F1" height="80.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="280.8574" x="228.65" y="1001.24"/><ellipse cx="308.9005" cy="1017.24" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M311.8692,1022.8806 Q311.2911,1023.1775 310.6505,1023.3181 Q310.0099,1023.4744 309.3067,1023.4744 Q306.8067,1023.4744 305.4786,1021.8338 Q304.1661,1020.1775 304.1661,1017.0525 Q304.1661,1013.9275 305.4786,1012.2713 Q306.8067,1010.615 309.3067,1010.615 Q310.0099,1010.615 310.6505,1010.7713 Q311.3067,1010.9275 311.8692,1011.2244 L311.8692,1013.9431 Q311.2442,1013.365 310.6505,1013.0994 Q310.0567,1012.8181 309.4317,1012.8181 Q308.088,1012.8181 307.4005,1013.8963 Q306.713,1014.9588 306.713,1017.0525 Q306.713,1019.1463 307.4005,1020.2244 Q308.088,1021.2869 309.4317,1021.2869 Q310.0567,1021.2869 310.6505,1021.0213 Q311.2442,1020.74 311.8692,1020.1619 L311.8692,1022.8806 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111.8564" x="329.4005" y="1022.0867">TokenException</text><line style="stroke:#181818;stroke-width:0.5;" x1="229.65" x2="508.5074" y1="1033.24" y2="1033.24"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="236.65" y="1043.8884"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142.249" x="248.65" y="1050.2351">ErrorType errorType</text><line style="stroke:#181818;stroke-width:0.5;" x1="229.65" x2="508.5074" y1="1057.5369" y2="1057.5369"/><ellipse cx="239.65" cy="1071.1853" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="254.8574" x="248.65" y="1074.532">requiresReAuthentication(): boolean</text></g><!--class ErrorType--><g class="entity" data-entity="ErrorType" data-source-line="59" data-uid="ent0008" id="entity_ErrorType"><rect fill="#F1F1F1" height="96.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="216.75" x="260.71" y="1182.58"/><ellipse cx="330.3272" cy="1198.58" fill="#EB937F" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M334.4366,1204.58 L326.7178,1204.58 L326.7178,1192.1894 L334.4366,1192.1894 L334.4366,1194.3456 L329.1709,1194.3456 L329.1709,1197.0175 L333.9366,1197.0175 L333.9366,1199.1738 L329.1709,1199.1738 L329.1709,1202.4238 L334.4366,1202.4238 L334.4366,1204.58 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69.0156" x="350.8272" y="1203.4267">ErrorType</text><line style="stroke:#181818;stroke-width:0.5;" x1="261.71" x2="476.46" y1="1214.58" y2="1214.58"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="204.75" x="266.71" y="1231.5751">AUTHENTICATION_REQUIRED</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="189.7383" x="266.71" y="1247.872">TOKEN_EXCHANGE_FAILED</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="120.7979" x="266.71" y="1264.1689">REFRESH_FAILED</text><line style="stroke:#181818;stroke-width:0.5;" x1="261.71" x2="476.46" y1="1271.4706" y2="1271.4706"/></g><!--class MessageRequest--><g class="entity" data-entity="MessageRequest" data-source-line="65" data-uid="ent0009" id="entity_MessageRequest"><rect fill="#F1F1F1" height="80.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="150.8564" x="572.65" y="253.52"/><ellipse cx="587.65" cy="269.52" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M590.6188,275.1606 Q590.0406,275.4575 589.4,275.5981 Q588.7594,275.7544 588.0563,275.7544 Q585.5563,275.7544 584.2281,274.1138 Q582.9156,272.4575 582.9156,269.3325 Q582.9156,266.2075 584.2281,264.5513 Q585.5563,262.895 588.0563,262.895 Q588.7594,262.895 589.4,263.0513 Q590.0563,263.2075 590.6188,263.5044 L590.6188,266.2231 Q589.9938,265.645 589.4,265.3794 Q588.8063,265.0981 588.1813,265.0981 Q586.8375,265.0981 586.15,266.1763 Q585.4625,267.2388 585.4625,269.3325 Q585.4625,271.4263 586.15,272.5044 Q586.8375,273.5669 588.1813,273.5669 Q588.8063,273.5669 589.4,273.3013 Q589.9938,273.02 590.6188,272.4419 L590.6188,275.1606 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="118.8564" x="601.65" y="274.3667">MessageRequest</text><line style="stroke:#181818;stroke-width:0.5;" x1="573.65" x2="722.5064" y1="285.52" y2="285.52"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="580.65" y="296.1684"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89.8857" x="592.65" y="302.5151">String chatId</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="580.65" y="312.4653"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99.832" x="592.65" y="318.812">String content</text><line style="stroke:#181818;stroke-width:0.5;" x1="573.65" x2="722.5064" y1="326.1138" y2="326.1138"/></g><!--class TokenStatus--><g class="entity" data-entity="TokenStatus" data-source-line="70" data-uid="ent0010" id="entity_TokenStatus"><rect fill="#F1F1F1" height="129.4844" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="294.3174" x="758.92" y="229.08"/><ellipse cx="858.1676" cy="245.08" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M861.1363,250.7206 Q860.5582,251.0175 859.9176,251.1581 Q859.2769,251.3144 858.5738,251.3144 Q856.0738,251.3144 854.7457,249.6737 Q853.4332,248.0175 853.4332,244.8925 Q853.4332,241.7675 854.7457,240.1112 Q856.0738,238.455 858.5738,238.455 Q859.2769,238.455 859.9176,238.6112 Q860.5738,238.7675 861.1363,239.0644 L861.1363,241.7831 Q860.5113,241.205 859.9176,240.9394 Q859.3238,240.6581 858.6988,240.6581 Q857.3551,240.6581 856.6676,241.7362 Q855.9801,242.7987 855.9801,244.8925 Q855.9801,246.9862 856.6676,248.0644 Q857.3551,249.1269 858.6988,249.1269 Q859.3238,249.1269 859.9176,248.8612 Q860.5113,248.58 861.1363,248.0019 L861.1363,250.7206 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.3223" x="878.6676" y="249.9267">TokenStatus</text><line style="stroke:#181818;stroke-width:0.5;" x1="759.92" x2="1052.2374" y1="261.08" y2="261.08"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="766.92" y="271.7284"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="210.875" x="778.92" y="278.0751">boolean hasValidAccessToken</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="766.92" y="288.0253"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="216.5078" x="778.92" y="294.372">boolean hasValidRefreshToken</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="766.92" y="304.3222"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="265.6582" x="778.92" y="310.6689">LocalDateTime accessTokenExpiresAt</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="766.92" y="320.6191"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="268.3174" x="778.92" y="326.9657">LocalDateTime refreshTokenExpiresAt</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="766.92" y="336.9159"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="167.6719" x="778.92" y="343.2626">long minutesUntilExpiry</text><line style="stroke:#181818;stroke-width:0.5;" x1="759.92" x2="1052.2374" y1="350.5644" y2="350.5644"/></g><g class="entity" data-entity="GMN20" data-source-line="93" data-uid="ent0021" id="entity_GMN20"><path d="M451.75,727.16 L451.75,758.42 L416.94,762.42 L451.75,766.42 L451.75,797.6913 A0,0 0 0 0 451.75,797.6913 L680.4199,797.6913 A0,0 0 0 0 680.4199,797.6913 L680.4199,737.16 L670.4199,727.16 L451.75,727.16 A0,0 0 0 0 451.75,727.16" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M670.4199,727.16 L670.4199,737.16 L680.4199,737.16 L670.4199,727.16" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="200.1543" x="457.75" y="744.2269">Thread-safe v&#7899;i ReentrantLock</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172.8721" x="457.75" y="759.3597">Volatile fields cho visibility</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171.8564" x="457.75" y="774.4925">UTC timezone consistency</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207.6699" x="457.75" y="789.6253">Double-checked locking pattern</text></g><!--link TeamsController to TokenManager--><g class="link" data-entity-1="TeamsController" data-entity-2="TokenManager" data-source-line="79" data-uid="lnk11" id="link_TeamsController_TokenManager"><path codeLine="79" d="M257.41,142.58 C215.46,162.81 177.05,190.68 151.08,229.08 C112.34,286.36 141.0826,357.713 175.9726,413.113" fill="none" id="TeamsController-to-TokenManager" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="179.17,418.19,177.7585,408.4428,176.5055,413.9591,170.9891,412.7061,179.17,418.19" style="stroke:#181818;stroke-width:1;"/></g><!--link TeamsController to TeamsGraphClient--><g class="link" data-entity-1="TeamsController" data-entity-2="TeamsGraphClient" data-source-line="80" data-uid="lnk12" id="link_TeamsController_TeamsGraphClient"><path codeLine="80" d="M442.2,169.29 C423.72,194.9 407.3707,217.5743 391.1007,240.1243" fill="none" id="TeamsController-to-TeamsGraphClient" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="387.59,244.99,396.0998,240.0319,390.5155,240.9352,389.6122,235.351,387.59,244.99" style="stroke:#181818;stroke-width:1;"/></g><!--link TeamsController to MessageRequest--><g class="link" data-entity-1="TeamsController" data-entity-2="MessageRequest" data-source-line="81" data-uid="lnk13" id="link_TeamsController_MessageRequest"><path codeLine="81" d="M558.36,169.29 C579.31,198.13 598.504,224.5554 615.834,248.4154" fill="none" id="TeamsController-to-MessageRequest" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="619.36,253.27,617.3074,243.6374,616.4217,249.2245,610.8346,248.3387,619.36,253.27" style="stroke:#181818;stroke-width:1;"/></g><!--link TeamsController to TokenStatus--><g class="link" data-entity-1="TeamsController" data-entity-2="TokenStatus" data-source-line="82" data-uid="lnk14" id="link_TeamsController_TokenStatus"><path codeLine="82" d="M660.25,169.43 C699.4,189.08 735.4072,207.1593 772.8172,225.9293" fill="none" id="TeamsController-to-TokenStatus" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="778.18,228.62,771.9296,221.0087,773.711,226.3777,768.3419,228.1591,778.18,228.62" style="stroke:#181818;stroke-width:1;"/></g><!--reverse link TokenManager to MicrosoftGraphTokenManager--><g class="link" data-entity-1="TokenManager" data-entity-2="MicrosoftGraphTokenManager" data-source-line="84" data-uid="lnk15" id="link_TokenManager_MicrosoftGraphTokenManager"><path codeLine="84" d="M234.08,582.53 C234.08,600.97 234.08,603.42 234.08,623.97" fill="none" id="TokenManager-backto-MicrosoftGraphTokenManager" style="stroke:#181818;stroke-width:1;"/><polygon fill="none" points="234.08,564.53,228.08,582.53,240.08,582.53,234.08,564.53" style="stroke:#181818;stroke-width:1;"/></g><!--link TeamsGraphClient to TokenManager--><g class="link" data-entity-1="TeamsGraphClient" data-entity-2="TokenManager" data-source-line="85" data-uid="lnk16" id="link_TeamsGraphClient_TokenManager"><path codeLine="85" d="M323.97,342.68 C310.14,365.42 296.4389,387.9543 281.0989,413.1643" fill="none" id="TeamsGraphClient-to-TokenManager" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="277.98,418.29,286.0755,412.6808,280.5791,414.0186,279.2413,408.5222,277.98,418.29" style="stroke:#181818;stroke-width:1;"/></g><!--link MicrosoftGraphTokenManager to GraphProperties--><g class="link" data-entity-1="MicrosoftGraphTokenManager" data-entity-2="GraphProperties" data-source-line="87" data-uid="lnk17" id="link_MicrosoftGraphTokenManager_GraphProperties"><path codeLine="87" d="M167.67,900.76 C157.8,921.18 150.5226,936.2287 141.4726,954.9387" fill="none" id="MicrosoftGraphTokenManager-to-GraphProperties" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="138.86,960.34,146.3798,953.9798,141.0372,955.8389,139.178,950.4963,138.86,960.34" style="stroke:#181818;stroke-width:1;"/></g><!--link MicrosoftGraphTokenManager to TokenException--><g class="link" data-entity-1="MicrosoftGraphTokenManager" data-entity-2="TokenException" data-source-line="88" data-uid="lnk18" id="link_MicrosoftGraphTokenManager_TokenException"><path codeLine="88" d="M300.99,900.76 C318.89,937.51 334.2236,968.9754 347.1936,995.6154" fill="none" id="MicrosoftGraphTokenManager-to-TokenException" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="349.82,1001.01,349.4768,991.1671,347.6313,996.5145,342.2839,994.669,349.82,1001.01" style="stroke:#181818;stroke-width:1;"/></g><!--link TokenException to ErrorType--><g class="link" data-entity-1="TokenException" data-entity-2="ErrorType" data-source-line="90" data-uid="lnk19" id="link_TokenException_ErrorType"><path codeLine="90" d="M369.08,1082.3 C369.08,1111.54 369.08,1145.4 369.08,1176.35" fill="none" id="TokenException-to-ErrorType" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="369.08,1182.35,373.08,1173.35,369.08,1177.35,365.08,1173.35,369.08,1182.35" style="stroke:#181818;stroke-width:1;"/></g><!--SRC=[ZLPTSjem47xtAVHMEgqlqCbaXe99c0RIWidqBIFa1MiGaYl9J4ZRa_GeFKrlqfLiWt-0m0j8- -slljs52MeCYO5kpK19gvKGeCdFWE0d9B7QW9nGITTuQMk7IkxqxZJDqe7W82snhGkF-q0Co6G2ng1gh_oUmOySZ7t_YSp0P4eQYAJbTdypjvhBzUr1q_eW33hEgH3xthowkT92IcKYO82wIyeslK98c4hWBSrrwMbkgSrDhmklIIiTeTOgjxtpfdy70PSMz8eoQDRtvz7j40IigON40vorGhr4m0l3hDOmm2H6IXUW0e5GVwoybnfC02rmFe-TuidHMp-tgTBybLgkv4ABZhzk8Mh7zaCDkGPctKDv4n_98J3l5VDdddCJphGoQcKzNKvK8dGbj35iCu6b8BfsAELUywjM6MZBmP1rytomWaJKLDe7nJO5YzslKhfJQ90BACCaIQFqPq0QLXXEUXA2jgaOeeMORw5m5xraNEyl0-icQ_YhEN5j_OiWu0KhmcpXQAJLjiMXHcob3ZSUz4G5JvpxfLB8gYf_Hf5pnnIwW3B1FcCu00wOManvbZY71KaR9EvmfpDthXrObndL75JLf4Yf7ITL6N5mOFTAsmcfpSKgeahDnpbEJjtEWMcmJGdwe5syXiI_xaBpfi0mT5ozavl3BlNF-Me5Ui9bRW_Du8HrgWtftjJgMh2FGUP6mI67I6kSCliC25I_odffdC4O4SvYDqGm5yxy5Aa_Fre7cMzhLWgx_KLy7qtZyQ0VZn-dpxFess8yYuPU5Zz-YQRFqVV1VNzw5psF-kE7KZABHhDeVbzT7ST9OwrqokyViNLNl6Gh-sAe7VJB972B64_y6dtF86RTsT3iT7equViFJD-U17P6GWqf56QmBPvsWMKNvSp0PDuXouL_1PFop0JjvHw6juq-EGreB_9Je6RDppig5qNGwCwRNs5uOGa4dHxln1rSM24Et6h9j-1DyfVH7fl1GGuK3WAft0JXwzGIjRgK1v8vrK2JqD0LaDs_ltzuSoKXugdQ2IiE8Z58LqLstF0b5_ZV0G6BU40iSk9LIN34DTmWTvaJ3LM-512o5DW64YG6spXsPzJYlmo9hPSG5-j_]--></g></svg>